"use strict";(self["webpackChunkict_itmo"]=self["webpackChunkict_itmo"]||[]).push([[9459],{72585:function(t,e,a){a.r(e),a.d(e,{default:function(){return _}});var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return t.loading&&Object.keys(t.announcement).length?i("v-container",[t.isPreview?i("div",[i("BaseNews",{attrs:{data:t.previewData}}),i("BaseButtonOutlined",{attrs:{text:"Назад","click-btn":!0},on:{clickBtnCallback:function(e){t.isPreview=!1}}})],1):i("div",[i("div",{staticClass:"input-bordered mb-6"},[i("v-text-field",{staticClass:"input-border-0 text-h6 input-blue font-weight-bold",attrs:{placeholder:"Название анонса",outlined:"",dense:"",dark:"dark"===t.theme,"hide-details":""},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),i("DraggableInputs",{attrs:{blocks:t.form.blocks},on:{changeDialogContent:t.changeDialogContent,changeDialog:t.changeDialog,beforeCropInsert:t.beforeCropInsert,deleteBlock:t.deleteBlock,updateBlock:t.updateBlock,beforeCropMultipleInsert:t.beforeCropMultipleInsert}}),i("div",{staticClass:"input-bordered"},[i("v-checkbox",{staticClass:"input-blue pl-2",attrs:{dark:"dark"===t.theme,dense:"",label:"Добавить в слайдер"},model:{value:t.form.isSlider,callback:function(e){t.$set(t.form,"isSlider",e)},expression:"form.isSlider"}}),t.form.isSlider?i("div",{staticClass:"py-6"},[i("div",{staticClass:"input-file-container mx-auto",on:{dragover:function(t){t.preventDefault()},drop:function(t){t.preventDefault()}}},[i("input",{attrs:{id:"sliderImg",type:"file",accept:"image/*"},on:{change:function(e){t.beforeCrop("sliderImg",{w:912,h:400},"Слайдер",e.target.files[0])}}}),i("label",{staticClass:"d-flex align-center py-6 px-12 text-center",attrs:{for:"sliderImg"},on:{change:function(e){t.beforeCrop("sliderImg",{w:912,h:400},"Слайдер",e.dataTransfer.files[0])}}},[i("v-img",{staticStyle:{"z-index":"0"},attrs:{width:"80",height:"80",src:a(42012)}}),t._v(" Выберите изображение обложки или перетащите файл"),i("br"),t._v(" Размер 1140*500 ")],1)]),!t.form.sliderImg&&t.form.sliderImgCroppie?i("a",{staticClass:"img-name text-center",attrs:{href:t.form.sliderImgCroppie,target:"_blank"}},[t._v(t._s(t.form.sliderImgCroppie))]):t._e(),t.form.sliderImg?i("div",{staticClass:"text-center"},[t._v(" "+t._s(t.form.sliderImg.name)+" ")]):t._e()]):t._e()],1),i("div",{staticClass:"px-0 mt-4 subtitle-color",staticStyle:{cursor:"pointer",width:"fit-content"},on:{click:t.addBlock}},[i("v-icon",{attrs:{color:"#0071B2"}},[t._v(" mdi-plus-circle-outline ")]),t._v(" Добавить поле ")],1),i("v-row",{staticClass:"pt-4"},[i("v-col",{attrs:{cols:"12",md:"3"}},[i("div",{staticClass:"pl-4 subtitle-color text-body-2",staticStyle:{opacity:"0.7"}},[t._v(" Дата начала мероприятия"),i("span",{staticClass:"error--text"},[t._v("*")])]),i("v-text-field",{staticClass:"search-input",attrs:{type:"date",outlined:"",dense:"",dark:"dark"===t.theme,color:"dark"===t.theme?"#00A1FF":"#005A8E","hide-details":""},model:{value:t.form.dateStart,callback:function(e){t.$set(t.form,"dateStart",e)},expression:"form.dateStart"}})],1),i("v-col",{attrs:{cols:"12",md:"3"}},[i("div",{staticClass:"pl-4 subtitle-color text-body-2",staticStyle:{opacity:"0.7"}},[t._v(" Дата конца мероприятия ")]),i("v-text-field",{staticClass:"search-input",attrs:{type:"date",outlined:"",dense:"",dark:"dark"===t.theme,color:"dark"===t.theme?"#00A1FF":"#005A8E","hide-details":""},model:{value:t.form.dateEnd,callback:function(e){t.$set(t.form,"dateEnd",e)},expression:"form.dateEnd"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("div",{staticClass:"pl-4 subtitle-color text-body-2",staticStyle:{opacity:"0.7"}},[t._v(" Время начала ")]),i("v-text-field",{staticClass:"search-input",attrs:{type:"time",outlined:"",dense:"",dark:"dark"===t.theme,color:"dark"===t.theme?"#00A1FF":"#005A8E","hide-details":""},model:{value:t.form.timeStart,callback:function(e){t.$set(t.form,"timeStart",e)},expression:"form.timeStart"}})],1)],1),i("v-row",[i("v-col",{attrs:{cols:"12",md:"3"}},[i("div",{staticClass:"pl-4 subtitle-color text-body-2",staticStyle:{opacity:"0.7"}},[t._v(" Дата выхода поста"),i("span",{staticClass:"error--text"},[t._v("*")])]),i("v-text-field",{staticClass:"search-input",attrs:{type:"date",outlined:"",dense:"",dark:"dark"===t.theme,color:"dark"===t.theme?"#00A1FF":"#005A8E","hide-details":""},model:{value:t.form.datePublish,callback:function(e){t.$set(t.form,"datePublish",e)},expression:"form.datePublish"}})],1),i("v-col",{attrs:{cols:"12",md:"2"}},[i("div",{staticClass:"pl-4 subtitle-color text-body-2",staticStyle:{opacity:"0.7"}},[t._v(" Время выхода"),i("span",{staticClass:"error--text"},[t._v("*")])]),i("v-text-field",{staticClass:"search-input",attrs:{type:"time",outlined:"",dense:"",dark:"dark"===t.theme,color:"dark"===t.theme?"#00A1FF":"#005A8E","hide-details":""},model:{value:t.form.timePublish,callback:function(e){t.$set(t.form,"timePublish",e)},expression:"form.timePublish"}})],1)],1),i("v-col",{staticClass:"px-0",attrs:{cols:"12",md:"4"}},[i("div",{staticClass:"pl-4 subtitle-color text-body-2",staticStyle:{opacity:"0.7"}},[t._v(" Место проведения"),i("span",{staticClass:"error--text"},[t._v("*")])]),i("v-text-field",{staticClass:"search-input",attrs:{placeholder:"Введите место мероприятия",outlined:"",dense:"",dark:"dark"===t.theme,color:"dark"===t.theme?"#00A1FF":"#005A8E","hide-details":""},model:{value:t.form.place,callback:function(e){t.$set(t.form,"place",e)},expression:"form.place"}})],1),i("v-col",{staticClass:"px-0",attrs:{cols:"12",md:"4"}},[i("div",{staticClass:"pl-4 subtitle-color  text-body-2",staticStyle:{opacity:"0.7"}},[t._v(" Теги"),i("span",{staticClass:"error--text"},[t._v("*")])]),i("v-autocomplete",{staticClass:"search-input",attrs:{items:t.tags,"item-value":"id","item-text":"name",multiple:"",outlined:"",dense:"",dark:"dark"===t.theme,color:"dark"===t.theme?"#00A1FF":"#005A8E","hide-details":"",chips:"","append-icon":"mdi-chevron-down"},scopedSlots:t._u([{key:"selection",fn:function(e){var a=e.item;return[i("BaseChip",{staticClass:"mr-3",attrs:{item:a},scopedSlots:t._u([{key:"chip-btns",fn:function(){return[i("v-btn",{attrs:{icon:"",dark:"","x-small":""},on:{click:function(e){return t.removeTag(a)}}},[i("v-icon",{attrs:{small:""}},[t._v(" mdi-close-circle-outline ")])],1)]},proxy:!0}],null,!0)})]}}],null,!1,7897401),model:{value:t.form.tagsIds,callback:function(e){t.$set(t.form,"tagsIds",e)},expression:"form.tagsIds"}})],1),i("div",{staticClass:"d-flex pt-6"},[i("BaseButton",{attrs:{text:"Опубликовать","click-btn":!0,"disabled-btn":t.canBePublished()},on:{clickBtnCallback:t.publish}}),i("BaseButtonOutlined",{staticClass:"ml-4",attrs:{text:"Предпросмотр","click-btn":!0},on:{clickBtnCallback:t.preview}})],1)],1),i("DialogPreviewComponent",{attrs:{dialog:t.dialog,"dialog-content":t.dialogContent},on:{changeDialog:t.changeDialog,beforeCropInsert:t.beforeCropInsert,beforeCropMultipleInsertOne:t.beforeCropMultipleInsertOne}}),i("DialogCroppieComponent",{attrs:{dialog:t.dialogCroppie,title:t.dialogCroppieOptions.title,size:t.dialogCroppieOptions.size,"data-img":t.dialogCroppieDataImg,"enable-resize":t.dialogCroppieOptions.enableResize},on:{changeDialog:t.changeDialogCroppie,changeCroppie:t.changeCroppie}}),i("DialogCroppieMultipleComponent",{attrs:{dialog:t.dialogCroppieMultiple,"data-img":t.dialogCroppieMultipleDataImg,edit:t.dialogCroppieMultipleEdit},on:{changeDialog:t.changeDialogCroppieMultiple,changeCroppie:t.changeCroppieMultiple}})],1):t.loading?i("BaseNotFound"):i("div",{staticClass:"d-flex justify-center fill-height align-center"},[i("v-progress-circular",{attrs:{indeterminate:""}})],1)},n=[],s=a(62032),o=a(16198),r=a(4367),l=(a(35666),a(41539),a(78783),a(33948),a(47941),a(21249),a(40561),a(74916),a(23123),a(54747),a(69826),a(20629)),c=a(22100),d=a(47566),u=a(19522),m={name:"AdminUpdateAnnouncementView",components:{BaseNotFound:function(){return a.e(6643).then(a.bind(a,6643))},DialogCroppieMultipleComponent:function(){return Promise.all([a.e(3548),a.e(1045)]).then(a.bind(a,86229))},DialogCroppieComponent:function(){return Promise.all([a.e(3548),a.e(9945)]).then(a.bind(a,44529))},DialogPreviewComponent:function(){return Promise.all([a.e(3548),a.e(2020)]).then(a.bind(a,74202))},BaseNews:function(){return a.e(5356).then(a.bind(a,99541))},DraggableInputs:function(){return Promise.all([a.e(2739),a.e(9980),a.e(3879),a.e(2082)]).then(a.bind(a,53879))},BaseChip:function(){return a.e(4494).then(a.bind(a,44494))},BaseButtonOutlined:function(){return a.e(2149).then(a.bind(a,2149))},BaseButton:function(){return a.e(1992).then(a.bind(a,1992))}},mixins:[c.Z,d.Z,u.Z],data:function(){return{loading:!1,dialog:!1,dialogContent:{},isPreview:!1,previewData:{},form:{title:"",dateStart:null,dateEnd:null,timeStart:null,datePublish:null,timePublish:null,place:"",tagsIds:[],isSlider:!1,sliderImg:null,sliderImgCroppie:null,sliderImgBlob:null,blocks:[{id:0,type:-1,content:null}],attachmentsIds:[]}}},computed:(0,r.Z)((0,r.Z)({},(0,l.rn)("app",["theme"])),(0,l.rn)("news",["tagsCategories","tags","announcement"])),mounted:function(){var t=this;return(0,o.Z)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getTags();case 2:return e.next=4,t.getAnnouncement(t.$route.params.id);case 4:Object.keys(t.announcement).length&&t.dataToForm(),t.loading=!0;case 6:case"end":return e.stop()}}),e)})))()},methods:(0,r.Z)((0,r.Z)((0,r.Z)({},(0,l.nv)("news",["getTags","getAnnouncement"])),(0,l.nv)("admin",["addAttachment","updateAnnouncement"])),{},{dataToForm:function(){this.form.id=this.announcement.id,this.form.title=this.announcement.title,this.form.place=this.announcement.place,this.form.dateStart=this.$moment(this.announcement.dateStart).format("YYYY-MM-DD"),this.form.dateEnd=this.announcement.dateEnd?this.$moment(this.announcement.dateEnd).format("YYYY-MM-DD"):"",this.form.timeStart=this.$moment(this.announcement.dateStart).format("HH:mm"),this.form.tagsIds=this.announcement.tags.map((function(t){return t.id})),this.form.blocks=this.dataToFormBlocks(this.announcement.blocks),this.count=this.form.blocks.length+1},canBePublished:function(){var t,e=!0,a=(0,s.Z)(this.form.blocks);try{for(a.s();!(t=a.n()).done;){var i=t.value;if(-1===i.type){e=!1;break}}}catch(n){a.e(n)}finally{a.f()}return!(this.form.place&&this.form.title&&this.form.dateStart&&this.form.tagsIds.length&&this.form.blocks.length&&e)},removeTag:function(t){var e=this.form.tagsIds.indexOf(t.id);e>=0&&this.form.tagsIds.splice(e,1)},publish:function(){var t=this;return(0,o.Z)(regeneratorRuntime.mark((function e(){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=Object.assign({},t.form),a.timeStart&&(i=a.timeStart.split(":"),a.dateStart=new Date(a.dateStart),a.dateStart.setHours(parseInt(i[0]),parseInt(i[1]))),a.dateStart=t.$moment(a.dateStart).format(),a.dateEnd?a.dateEnd=t.$moment(a.dateEnd).format():a.dateEnd=null,e.next=6,t.publishBlocks(a.blocks);case 6:return a.blocks=e.sent,e.next=9,t.updateAnnouncement(a);case 9:t.$router.push("/published").then();case 10:case"end":return e.stop()}}),e)})))()},preview:function(){var t=this;this.previewData=Object.assign({},this.form),this.previewData.tags=[],this.previewData.tagsIds.forEach((function(e,a){t.previewData.tags[a]=t.tags.find((function(t){return t.id===e}))})),this.isPreview=!0}})},p=m,h=a(1001),f=a(43453),g=a.n(f),v=a(71835),b=a(63150),C=a(83702),k=a(82102),x=a(99846),y=a(96428),I=a(97047),w=a(90624),S=a(62877),D=a(40314),B=(0,h.Z)(p,i,n,!1,null,null,null),_=B.exports;g()(B,{VAutocomplete:v.Z,VBtn:b.Z,VCheckbox:C.Z,VCol:k.Z,VContainer:x.Z,VIcon:y.Z,VImg:I.Z,VProgressCircular:w.Z,VRow:S.Z,VTextField:D.Z})}}]);
//# sourceMappingURL=9459-legacy.f20a9c64.js.map