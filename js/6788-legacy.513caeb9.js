(self["webpackChunkict_itmo"]=self["webpackChunkict_itmo"]||[]).push([[6788],{38862:function(e,t,n){var i=n(82109),r=n(17854),a=n(35005),o=n(22104),c=n(1702),s=n(47293),l=r.Array,u=a("JSON","stringify"),p=c(/./.exec),m=c("".charAt),d=c("".charCodeAt),g=c("".replace),f=c(1..toString),b=/[\uD800-\uDFFF]/g,h=/^[\uD800-\uDBFF]$/,v=/^[\uDC00-\uDFFF]$/,k=function(e,t,n){var i=m(n,t-1),r=m(n,t+1);return p(h,e)&&!p(v,r)||p(v,e)&&!p(h,i)?"\\u"+f(d(e,0),16):e},x=s((function(){return'"\\udf06\\ud834"'!==u("\udf06\ud834")||'"\\udead"'!==u("\udead")}));u&&i({target:"JSON",stat:!0,forced:x},{stringify:function(e,t,n){for(var i=0,r=arguments.length,a=l(r);i<r;i++)a[i]=arguments[i];var c=o(u,null,a);return"string"==typeof c?g(c,b,k):c}})},42529:function(e,t,n){"use strict";n(9653);var i=n(4589),r=n(20144);t["Z"]=r.Z.extend({name:"measurable",props:{height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},computed:{measurableStyles:function(){var e={},t=(0,i.kb)(this.height),n=(0,i.kb)(this.minHeight),r=(0,i.kb)(this.minWidth),a=(0,i.kb)(this.maxHeight),o=(0,i.kb)(this.maxWidth),c=(0,i.kb)(this.width);return t&&(e.height=t),n&&(e.minHeight=n),r&&(e.minWidth=r),a&&(e.maxHeight=a),o&&(e.maxWidth=o),c&&(e.width=c),e}}})},56749:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return D}});var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.isLoad?i("v-container",[e.isPreview?i("div",[i("BaseStudentsArticleComponent",{attrs:{block:{title:e.form.title,description:e.form.description,caption:e.form.caption,image1:e.form.image1Croppie,image2:e.form.image2Croppie}}}),i("BaseNews",{attrs:{data:e.previewData}}),i("BaseButtonOutlined",{attrs:{text:"Назад","click-btn":!0},on:{clickBtnCallback:function(t){e.isPreview=!1}}})],1):i("div",[i("div",{staticClass:"pb-2 pb-md-4 text-h6 text-md-h5"},[e._v(" Статьи ")]),i("div",{staticClass:"input-bordered mb-8"},[i("v-text-field",{staticClass:"input-border-0 text-h6 input-blue font-weight-bold",attrs:{placeholder:"Название",outlined:"",dense:"",dark:"dark"===e.theme,"hide-details":""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),i("div",{staticClass:"input-bordered pt-3"},[i("div",{staticClass:"input-bordered-label app-background"},[e._v(" Описание "),i("span",{staticClass:"error--text"},[e._v("*")])]),i("vue-editor",{staticClass:"custom",attrs:{"editor-toolbar":e.customToolbar,placeholder:"Введите текст"},model:{value:e.form.description,callback:function(t){e.$set(e.form,"description",t)},expression:"form.description"}})],1),i("div",{staticClass:"text-end mb-6",style:{color:e.cutTegs(e.form.description||"").length>300?"red":"#0071B2"}},[e._v(" "+e._s(e.cutTegs(e.form.description||"").length)+"/300 ")]),i("div",{staticClass:"input-bordered mb-6 py-6"},[i("div",{staticClass:"input-bordered-label app-background"},[e._v(" Изображение 1 "),i("span",{staticClass:"error--text"},[e._v("*")])]),i("div",{staticClass:"input-file-container mx-auto",on:{dragover:function(e){e.preventDefault()},drop:function(e){e.preventDefault()}}},[i("input",{attrs:{id:"image1",type:"file",accept:"image/*"},on:{change:function(t){e.beforeCrop("image1",{w:400,h:300},"Изображение 1",t.target.files[0])}}}),i("label",{staticClass:"d-flex align-center py-6 px-12 text-center",attrs:{for:"image1"},on:{drop:function(t){e.beforeCrop("image1",{w:400,h:300},"Изображение 1",t.dataTransfer.files[0])}}},[i("v-img",{staticStyle:{"z-index":"0"},attrs:{width:"80",height:"80",src:n(42012)}}),e._v(" Выберите изображение или перетащите файл"),i("br"),e._v(" Размер 400*300 ")],1)]),e.form.image1?i("div",{staticClass:"text-center"},[e._v(" "+e._s(e.form.image1.name)+" ")]):e._e()]),i("div",{staticClass:"input-bordered mb-6 py-6"},[i("div",{staticClass:"input-bordered-label app-background"},[e._v(" Изображение 2 "),i("span",{staticClass:"error--text"},[e._v("*")])]),i("v-text-field",{staticClass:"mx-6 my-2 input-light-blue",attrs:{placeholder:"Подпись",outlined:"",dense:"",dark:"dark"===e.theme,"hide-details":""},model:{value:e.form.caption,callback:function(t){e.$set(e.form,"caption",t)},expression:"form.caption"}}),i("div",{staticClass:"input-file-container mx-auto",on:{dragover:function(e){e.preventDefault()},drop:function(e){e.preventDefault()}}},[i("input",{attrs:{id:"image2",type:"file",accept:"image/*"},on:{change:function(t){e.beforeCrop("image2",{w:300,h:300},"Изображение 2",t.target.files[0])}}}),i("label",{staticClass:"d-flex align-center py-6 px-12 text-center",attrs:{for:"image2"},on:{drop:function(t){e.beforeCrop("image2",{w:300,h:300},"Изображение 2",t.dataTransfer.files[0])}}},[i("v-img",{staticStyle:{"z-index":"0"},attrs:{width:"80",height:"80",src:n(42012)}}),e._v(" Выберите изображение или перетащите файл"),i("br"),e._v(" Размер 300*300 ")],1)]),e.form.image2?i("div",{staticClass:"text-center"},[e._v(" "+e._s(e.form.image2.name)+" ")]):e._e()],1),i("DraggableInputs",{attrs:{blocks:e.form.blocks},on:{changeDialogContent:e.changeDialogContent,changeDialog:e.changeDialog,beforeCropInsert:e.beforeCropInsert,deleteBlock:e.deleteBlock,updateBlock:e.updateBlock,beforeCropMultipleInsert:e.beforeCropMultipleInsert}}),i("div",{staticClass:"px-0 subtitle-color",staticStyle:{cursor:"pointer",width:"fit-content"},on:{click:e.addBlock}},[i("v-icon",{attrs:{color:"#0071B2"}},[e._v(" mdi-plus-circle-outline ")]),e._v(" Добавить поле ")],1),i("div",{staticClass:"d-flex pt-6"},[i("BaseButton",{attrs:{text:"Опубликовать","click-btn":!0},on:{clickBtnCallback:e.publish}}),i("BaseButtonOutlined",{staticClass:"ml-4",attrs:{text:"Предпросмотр","click-btn":!0},on:{clickBtnCallback:e.preview}})],1)],1),i("DialogPreviewComponent",{attrs:{dialog:e.dialog,"dialog-content":e.dialogContent},on:{changeDialog:e.changeDialog,beforeCropInsert:e.beforeCropInsert,beforeCropMultipleInsertOne:e.beforeCropMultipleInsertOne}}),i("DialogCroppieComponent",{attrs:{dialog:e.dialogCroppie,title:e.dialogCroppieOptions.title,size:e.dialogCroppieOptions.size,"data-img":e.dialogCroppieDataImg,"enable-resize":e.dialogCroppieOptions.enableResize},on:{changeDialog:e.changeDialogCroppie,changeCroppie:e.changeCroppie}}),i("DialogCroppieMultipleComponent",{attrs:{dialog:e.dialogCroppieMultiple,"data-img":e.dialogCroppieMultipleDataImg,edit:e.dialogCroppieMultipleEdit},on:{changeDialog:e.changeDialogCroppieMultiple,changeCroppie:e.changeCroppieMultiple}})],1):i("v-container",{staticClass:"d-flex justify-center fill-height align-center"},[i("v-progress-circular",{attrs:{indeterminate:""}})],1)},r=[],a=n(62032),o=n(16198),c=n(4367),s=(n(35666),n(41539),n(78783),n(33948),n(47941),n(74916),n(15306),n(82526),n(41817),n(38862),n(20629)),l=n(22100),u=n(47566),p=n(19522),m=n(2739),d={name:"TwoPhotosComponent",components:{VueEditor:m.bR,BaseStudentsArticleComponent:function(){return n.e(1306).then(n.bind(n,15796))},DialogCroppieMultipleComponent:function(){return Promise.all([n.e(2681),n.e(3548),n.e(4666)]).then(n.bind(n,39383))},DialogCroppieComponent:function(){return Promise.all([n.e(2681),n.e(3548),n.e(9656)]).then(n.bind(n,28493))},DialogPreviewComponent:function(){return Promise.all([n.e(2681),n.e(3548),n.e(7145)]).then(n.bind(n,74202))},BaseNews:function(){return n.e(5356).then(n.bind(n,99541))},DraggableInputs:function(){return Promise.all([n.e(2681),n.e(6999),n.e(9980),n.e(1247),n.e(2109)]).then(n.bind(n,91247))},BaseButtonOutlined:function(){return n.e(2149).then(n.bind(n,2149))},BaseButton:function(){return n.e(1992).then(n.bind(n,1992))}},mixins:[l.Z,u.Z,p.Z],data:function(){return{customToolbar:[{align:""},{align:"center"},{align:"justify"},{list:"ordered"},{list:"bullet"},"bold","italic","underline","link","clean"],isPreview:!1,previewData:{},form:{title:"",description:"",caption:"",image1:null,image1Croppie:null,image1Blob:null,image2:null,image2Croppie:null,image2Blob:null,blocks:[{id:0,type:-1,content:null}],attachmentsIds:[]},isLoad:!1}},computed:(0,c.Z)((0,c.Z)({},(0,s.rn)("app",["theme"])),(0,s.rn)("news",["article"])),mounted:function(){var e=this;return(0,o.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getArticle(e.$route.params.id);case 2:Object.keys(e.article).length&&e.dataToForm(),e.isLoad=!0;case 4:case"end":return t.stop()}}),t)})))()},methods:(0,c.Z)((0,c.Z)((0,c.Z)({},(0,s.nv)("news",["getArticle"])),(0,s.nv)("admin",["addAttachment","updateArticles"])),{},{dataToForm:function(){this.form.id=this.article.id,this.form.title=this.article.title,this.form.blocks=this.article.blocks;for(var e=0;e<this.form.blocks.length;e++){if(this.form.blocks[e].id=e,0===this.form.blocks[e].type){this.form.blocks[e].content.text=this.form.blocks[e].content.text.replace("<div>","").replace("</div>","");var t=new DOMParser;this.form.blocks[e].content.text=t.parseFromString(this.form.blocks[e].content.text,"text/html").body.innerHTML,this.form.blocks[e].content.text=this.form.blocks[e].content.text.replace(/\r/g,"").replace(/\n/g,"")}if(1===this.form.blocks[e].type){this.form.blocks[e].content.blocks[0].id=1e3*(e+1)+1,this.form.blocks[e].content.blocks[1].id=1e3*(e+1)+2;var n,i=(0,a.Z)(this.form.blocks[e].content.blocks);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(2===r.type&&(r.content.img=null,r.content.imgName.blob=null,r.content.imgName.original=r.content.imgName.croppie),3===r.type){r.content.images=[];var o,c=1,s=(0,a.Z)(r.content.imagesName);try{for(s.s();!(o=s.n()).done;){var l=o.value;r.content.images.push({name:c+" img"}),c+=1,l.original=l.croppie,l.blob=null}}catch(f){s.e(f)}finally{s.f()}}}}catch(f){i.e(f)}finally{i.f()}}if(2===this.form.blocks[e].type&&(this.form.blocks[e].content.img=null,this.form.blocks[e].content.imgName.blob=null,this.form.blocks[e].content.imgName.original=this.form.blocks[e].content.imgName.croppie),3===this.form.blocks[e].type){this.form.blocks[e].content.images=[];var u,p=1,m=(0,a.Z)(this.form.blocks[e].content.imagesName);try{for(m.s();!(u=m.n()).done;){var d=u.value;this.form.blocks[e].content.images.push({name:p+" img",id:p}),p+=1,d.original=d.croppie,d.blob=null}}catch(f){m.e(f)}finally{m.f()}}}this.count=this.form.blocks.length+1;var g=JSON.parse(this.article.description);this.form.caption=g.caption,this.form.description=g.description,this.form.image1Croppie=g.image1,this.form.image2Croppie=g.image2},publish:function(){var e=this;return(0,o.Z)(regeneratorRuntime.mark((function t(){var n,i,r,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=Object.assign({},e.form),n.page=e.article.page,!n.image1Blob){t.next=7;break}return t.next=5,e.addAttachment(n.image1Blob).then((function(e){n.image1=e.data.url})).catch((function(){return{}}));case 5:t.next=8;break;case 7:n.image1=n.image1Croppie;case 8:if(!n.image2Blob){t.next=13;break}return t.next=11,e.addAttachment(n.image2Blob).then((function(e){n.image2=e.data.url})).catch((function(){return{}}));case 11:t.next=14;break;case 13:n.image2=n.image2Croppie;case 14:n.description=JSON.stringify({description:n.description,caption:n.caption,image1:n.image1,image2:n.image2}),i=(0,a.Z)(n.blocks),t.prev=16,o=regeneratorRuntime.mark((function t(){var n,i,o,c,s,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=r.value,1!==n.type){t.next=18;break}i=(0,a.Z)(n.content.blocks),t.prev=3,c=regeneratorRuntime.mark((function t(){var n,i,r,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=o.value,2!==n.type||!n.content.imgName.blob){t.next=4;break}return t.next=4,e.addAttachment(n.content.imgName.blob).then((function(e){n.content.imgName.croppie=e.data.url})).catch((function(){return{}}));case 4:if(3!==n.type){t.next=22;break}i=(0,a.Z)(n.content.imagesName),t.prev=6,c=regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=r.value,!n["blob"]){t.next=4;break}return t.next=4,e.addAttachment(n["blob"]).then((function(e){n.croppie=e.data.url})).catch((function(){return{}}));case 4:delete n.original,delete n["blob"];case 6:case"end":return t.stop()}}),t)})),i.s();case 9:if((r=i.n()).done){t.next=13;break}return t.delegateYield(c(),"t0",11);case 11:t.next=9;break;case 13:t.next=18;break;case 15:t.prev=15,t.t1=t["catch"](6),i.e(t.t1);case 18:return t.prev=18,i.f(),t.finish(18);case 21:delete n.content.images;case 22:delete n.id,2===n.type&&(delete n.content.img,delete n.content.imgName.original,delete n.content.imgName.blob);case 24:case"end":return t.stop()}}),t,null,[[6,15,18,21]])})),i.s();case 6:if((o=i.n()).done){t.next=10;break}return t.delegateYield(c(),"t0",8);case 8:t.next=6;break;case 10:t.next=15;break;case 12:t.prev=12,t.t1=t["catch"](3),i.e(t.t1);case 15:return t.prev=15,i.f(),t.finish(15);case 18:if(2!==n.type||!n.content.imgName.blob){t.next=21;break}return t.next=21,e.addAttachment(n.content.imgName.blob).then((function(e){n.content.imgName.croppie=e.data.url})).catch((function(){return{}}));case 21:if(3!==n.type){t.next=39;break}s=(0,a.Z)(n.content.imagesName),t.prev=23,u=regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=l.value,!n["blob"]){t.next=4;break}return t.next=4,e.addAttachment(n["blob"]).then((function(e){n.croppie=e.data.url})).catch((function(){return{}}));case 4:delete n.original,delete n["blob"];case 6:case"end":return t.stop()}}),t)})),s.s();case 26:if((l=s.n()).done){t.next=30;break}return t.delegateYield(u(),"t2",28);case 28:t.next=26;break;case 30:t.next=35;break;case 32:t.prev=32,t.t3=t["catch"](23),s.e(t.t3);case 35:return t.prev=35,s.f(),t.finish(35);case 38:delete n.content.images;case 39:delete n.id,2===n.type&&(delete n.content.img,delete n.content.imgName.original,delete n.content.imgName.blob);case 41:case"end":return t.stop()}}),t,null,[[3,12,15,18],[23,32,35,38]])})),i.s();case 19:if((r=i.n()).done){t.next=23;break}return t.delegateYield(o(),"t0",21);case 21:t.next=19;break;case 23:t.next=28;break;case 25:t.prev=25,t.t1=t["catch"](16),i.e(t.t1);case 28:return t.prev=28,i.f(),t.finish(28);case 31:return t.next=33,e.updateArticles(n);case 33:e.$router.push("/favorites").then();case 34:case"end":return t.stop()}}),t,null,[[16,25,28,31]])})))()},preview:function(){this.previewData=Object.assign({},this.form),this.isPreview=!0},cutTegs:function(e){var t=/( |<([^>]+)>)/gi;return e.replace(t,"")}})},g=d,f=n(1001),b=n(43453),h=n.n(b),v=n(99846),k=n(96428),x=n(97047),C=n(90624),w=n(40314),y=(0,f.Z)(g,i,r,!1,null,null,null),D=y.exports;h()(y,{VContainer:v.Z,VIcon:k.Z,VImg:x.Z,VProgressCircular:C.Z,VTextField:w.Z})}}]);
//# sourceMappingURL=6788-legacy.513caeb9.js.map