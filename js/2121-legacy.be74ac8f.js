"use strict";(self["webpackChunkict_itmo"]=self["webpackChunkict_itmo"]||[]).push([[2121],{1163:function(e,t,a){a.r(t),a.d(t,{default:function(){return I}});var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-container",[e.isPreview?n("div",[n("BaseNews",{attrs:{data:e.previewData}}),n("BaseButtonOutlined",{attrs:{text:"Назад","click-btn":!0},on:{clickBtnCallback:function(t){e.isPreview=!1}}})],1):n("div",[n("div",{staticClass:"d-flex pb-6"},[n("BaseButtonOutlined",{staticClass:"rounded-r-0",attrs:{text:"Анонсы",active:0===e.typeData,"click-btn":!0},on:{clickBtnCallback:function(t){return e.changeTypeData(0)}}}),n("BaseButtonOutlined",{staticClass:"rounded-l-0 ml-2",attrs:{text:"Новости",active:1===e.typeData,"click-btn":!0},on:{clickBtnCallback:function(t){return e.changeTypeData(1)}}})],1),n("div",{staticClass:"input-bordered mb-6"},[n("v-text-field",{staticClass:"input-border-0 text-h6 input-blue font-weight-bold",attrs:{placeholder:"Название "+(1===e.typeData?"новости":"анонса"),outlined:"",dense:"",dark:"dark"===e.theme,"hide-details":""},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),n("DraggableInputs",{attrs:{blocks:e.form.blocks},on:{changeDialogContent:e.changeDialogContent,changeDialog:e.changeDialog,beforeCropInsert:e.beforeCropInsert,deleteBlock:e.deleteBlock,updateBlock:e.updateBlock,beforeCropMultipleInsert:e.beforeCropMultipleInsert}}),1===e.typeData?n("div",{staticClass:"input-bordered mb-6 py-6"},[n("div",{staticClass:"input-bordered-label app-background"},[e._v(" Обложка новости"),n("span",{staticClass:"error--text"},[e._v("*")])]),n("div",{staticClass:"input-file-container mx-auto",on:{dragover:function(e){e.preventDefault()},drop:function(e){e.preventDefault()}}},[n("input",{attrs:{id:"cover",type:"file",accept:"image/*"},on:{change:function(t){e.beforeCrop("cover",{w:480,h:300},"Обложка новости",t.target.files[0])}}}),n("label",{staticClass:"d-flex align-center py-6 px-12 text-center",attrs:{for:"cover"},on:{change:function(t){e.beforeCrop("cover",{w:480,h:300},"Обложка новости",t.dataTransfer.files[0])}}},[n("v-img",{staticStyle:{"z-index":"0"},attrs:{width:"80",height:"80",src:a(42012)}}),e._v(" Выберите изображение обложки или перетащите файл"),n("br"),e._v(" Размер 480*300 ")],1)]),e.form.cover?n("div",{staticClass:"text-center"},[e._v(" "+e._s(e.form.cover.name)+" ")]):e._e()]):e._e(),n("div",{staticClass:"input-bordered"},[n("v-checkbox",{staticClass:"input-blue pl-2",attrs:{dark:"dark"===e.theme,dense:"",label:"Добавить в слайдер"},model:{value:e.form.isSlider,callback:function(t){e.$set(e.form,"isSlider",t)},expression:"form.isSlider"}}),e.form.isSlider?n("div",{staticClass:"py-6"},[n("div",{staticClass:"input-file-container mx-auto",on:{dragover:function(e){e.preventDefault()},drop:function(e){e.preventDefault()}}},[n("input",{attrs:{id:"sliderImg",type:"file",accept:"image/*"},on:{change:function(t){e.beforeCrop("sliderImg",{w:912,h:400},"Слайдер",t.target.files[0])}}}),n("label",{staticClass:"d-flex align-center py-6 px-12 text-center",attrs:{for:"sliderImg"},on:{change:function(t){e.beforeCrop("sliderImg",{w:912,h:400},"Слайдер",t.dataTransfer.files[0])}}},[n("v-img",{staticStyle:{"z-index":"0"},attrs:{width:"80",height:"80",src:a(42012)}}),e._v(" Выберите изображение обложки или перетащите файл"),n("br"),e._v(" Размер 1140*500 ")],1)]),e.form.sliderImg?n("div",{staticClass:"text-center"},[e._v(" "+e._s(e.form.sliderImg.name)+" ")]):e._e()]):e._e()],1),n("div",{staticClass:"px-0 mt-4 subtitle-color",staticStyle:{cursor:"pointer",width:"fit-content"},on:{click:e.addBlock}},[n("v-icon",{attrs:{color:"#0071B2"}},[e._v(" mdi-plus-circle-outline ")]),e._v(" Добавить поле ")],1),n("v-row",{staticClass:"pt-4"},[n("v-col",{attrs:{cols:"12",md:"3"}},[n("div",{staticClass:"pl-4 subtitle-color text-body-2",staticStyle:{opacity:"0.7"}},[e._v(" Дата начала мероприятия"),n("span",{staticClass:"error--text"},[e._v("*")])]),n("v-text-field",{staticClass:"search-input",attrs:{type:"date",outlined:"",dense:"",dark:"dark"===e.theme,color:"dark"===e.theme?"#00A1FF":"#005A8E","hide-details":""},model:{value:e.form.dateStart,callback:function(t){e.$set(e.form,"dateStart",t)},expression:"form.dateStart"}})],1),0===e.typeData?n("v-col",{attrs:{cols:"12",md:"3"}},[n("div",{staticClass:"pl-4 subtitle-color text-body-2",staticStyle:{opacity:"0.7"}},[e._v(" Дата конца мероприятия ")]),n("v-text-field",{staticClass:"search-input",attrs:{type:"date",outlined:"",dense:"",dark:"dark"===e.theme,color:"dark"===e.theme?"#00A1FF":"#005A8E","hide-details":""},model:{value:e.form.dateEnd,callback:function(t){e.$set(e.form,"dateEnd",t)},expression:"form.dateEnd"}})],1):e._e(),n("v-col",{attrs:{cols:"12",md:"2"}},[n("div",{staticClass:"pl-4 subtitle-color text-body-2",staticStyle:{opacity:"0.7"}},[e._v(" Время начала ")]),n("v-text-field",{staticClass:"search-input",attrs:{type:"time",outlined:"",dense:"",dark:"dark"===e.theme,color:"dark"===e.theme?"#00A1FF":"#005A8E","hide-details":""},model:{value:e.form.timeStart,callback:function(t){e.$set(e.form,"timeStart",t)},expression:"form.timeStart"}})],1)],1),n("v-row",[n("v-col",{attrs:{cols:"12",md:"3"}},[n("div",{staticClass:"pl-4 subtitle-color text-body-2",staticStyle:{opacity:"0.7"}},[e._v(" Дата выхода поста"),n("span",{staticClass:"error--text"},[e._v("*")])]),n("v-text-field",{staticClass:"search-input",attrs:{type:"date",outlined:"",dense:"",dark:"dark"===e.theme,color:"dark"===e.theme?"#00A1FF":"#005A8E","hide-details":""},model:{value:e.form.datePublish,callback:function(t){e.$set(e.form,"datePublish",t)},expression:"form.datePublish"}})],1),n("v-col",{attrs:{cols:"12",md:"2"}},[n("div",{staticClass:"pl-4 subtitle-color text-body-2",staticStyle:{opacity:"0.7"}},[e._v(" Время выхода"),n("span",{staticClass:"error--text"},[e._v("*")])]),n("v-text-field",{staticClass:"search-input",attrs:{type:"time",outlined:"",dense:"",dark:"dark"===e.theme,color:"dark"===e.theme?"#00A1FF":"#005A8E","hide-details":""},model:{value:e.form.timePublish,callback:function(t){e.$set(e.form,"timePublish",t)},expression:"form.timePublish"}})],1)],1),0===e.typeData?n("v-col",{staticClass:"px-0",attrs:{cols:"12",md:"4"}},[n("div",{staticClass:"pl-4 subtitle-color text-body-2",staticStyle:{opacity:"0.7"}},[e._v(" Место проведения"),n("span",{staticClass:"error--text"},[e._v("*")])]),n("v-text-field",{staticClass:"search-input",attrs:{placeholder:"Введите место мероприятия",outlined:"",dense:"",dark:"dark"===e.theme,color:"dark"===e.theme?"#00A1FF":"#005A8E","hide-details":""},model:{value:e.form.place,callback:function(t){e.$set(e.form,"place",t)},expression:"form.place"}})],1):e._e(),n("v-col",{staticClass:"px-0",attrs:{cols:"12",md:"4"}},[n("div",{staticClass:"pl-4 subtitle-color  text-body-2",staticStyle:{opacity:"0.7"}},[e._v(" Теги"),n("span",{staticClass:"error--text"},[e._v("*")])]),n("v-autocomplete",{staticClass:"search-input",attrs:{items:e.tags,"item-value":"id","item-text":"name",multiple:"",outlined:"",dense:"",dark:"dark"===e.theme,color:"dark"===e.theme?"#00A1FF":"#005A8E","hide-details":"",chips:"","append-icon":"mdi-chevron-down"},scopedSlots:e._u([{key:"selection",fn:function(t){var a=t.item;return[n("BaseChip",{staticClass:"mr-3",attrs:{item:a},scopedSlots:e._u([{key:"chip-btns",fn:function(){return[n("v-btn",{attrs:{icon:"",dark:"","x-small":""},on:{click:function(t){return e.removeTag(a)}}},[n("v-icon",{attrs:{small:""}},[e._v(" mdi-close-circle-outline ")])],1)]},proxy:!0}],null,!0)})]}}],null,!1,7897401),model:{value:e.form.tagsIds,callback:function(t){e.$set(e.form,"tagsIds",t)},expression:"form.tagsIds"}})],1),n("div",{staticClass:"d-flex pt-6"},[n("BaseButton",{attrs:{text:"Опубликовать","click-btn":!0,"disabled-btn":e.canBePublished()},on:{clickBtnCallback:e.publish}}),n("BaseButtonOutlined",{staticClass:"ml-4",attrs:{text:"Предпросмотр","click-btn":!0},on:{clickBtnCallback:e.preview}})],1)],1),n("DialogPreviewComponent",{attrs:{dialog:e.dialog,"dialog-content":e.dialogContent},on:{changeDialog:e.changeDialog,beforeCropInsert:e.beforeCropInsert,beforeCropMultipleInsertOne:e.beforeCropMultipleInsertOne}}),n("DialogCroppieComponent",{attrs:{dialog:e.dialogCroppie,title:e.dialogCroppieOptions.title,size:e.dialogCroppieOptions.size,"data-img":e.dialogCroppieDataImg,"enable-resize":e.dialogCroppieOptions.enableResize},on:{changeDialog:e.changeDialogCroppie,changeCroppie:e.changeCroppie}}),n("DialogCroppieMultipleComponent",{attrs:{dialog:e.dialogCroppieMultiple,"data-img":e.dialogCroppieMultipleDataImg,edit:e.dialogCroppieMultipleEdit},on:{changeDialog:e.changeDialogCroppieMultiple,changeCroppie:e.changeCroppieMultiple}})],1)},r=[],i=a(62032),s=a(16198),o=a(4367),l=(a(35666),a(41539),a(78783),a(33948),a(40561),a(74916),a(23123),a(54747),a(69826),a(20629)),c=a(22100),d=a(47566),u=a(19522),p={name:"AdminCreateEntryView",components:{DialogCroppieMultipleComponent:function(){return Promise.all([a.e(3548),a.e(1152)]).then(a.bind(a,39383))},DialogCroppieComponent:function(){return Promise.all([a.e(3548),a.e(1133)]).then(a.bind(a,28493))},DialogPreviewComponent:function(){return Promise.all([a.e(3548),a.e(2020)]).then(a.bind(a,74202))},BaseNews:function(){return a.e(5356).then(a.bind(a,99541))},DraggableInputs:function(){return Promise.all([a.e(2739),a.e(9980),a.e(1247),a.e(3307)]).then(a.bind(a,91247))},BaseChip:function(){return a.e(4494).then(a.bind(a,44494))},BaseButtonOutlined:function(){return a.e(2149).then(a.bind(a,2149))},BaseButton:function(){return a.e(1992).then(a.bind(a,1992))}},mixins:[c.Z,d.Z,u.Z],data:function(){return{dialog:!1,dialogContent:{},typeData:0,isPreview:!1,previewData:{},form:{title:"",dateStart:null,dateEnd:null,timeStart:null,datePublish:null,timePublish:null,place:"",tagsIds:[],isSlider:!1,sliderImg:null,sliderImgCroppie:null,sliderImgBlob:null,cover:null,coverCroppie:null,coverBlob:null,blocks:[{id:0,type:-1,content:null}],attachmentsIds:[]}}},computed:(0,o.Z)((0,o.Z)({},(0,l.rn)("app",["theme"])),(0,l.rn)("news",["tagsCategories","tags"])),mounted:function(){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getTags();case 2:case"end":return t.stop()}}),t)})))()},methods:(0,o.Z)((0,o.Z)((0,o.Z)({},(0,l.nv)("news",["getTags"])),(0,l.nv)("admin",["addAttachment","addNews","addAnnouncement"])),{},{canBePublished:function(){var e=!0;1!==this.typeData||this.form.cover||(e=!1),0!==this.typeData||this.form.place||(e=!1);var t,a=(0,i.Z)(this.form.blocks);try{for(a.s();!(t=a.n()).done;){var n=t.value;if(-1===n.type){e=!1;break}}}catch(r){a.e(r)}finally{a.f()}return!(this.form.title&&this.form.dateStart&&this.form.tagsIds.length&&this.form.blocks.length&&e)},changeTypeData:function(e){this.typeData=e},removeTag:function(e){var t=this.form.tagsIds.indexOf(e.id);t>=0&&this.form.tagsIds.splice(t,1)},publish:function(){var e=this;return(0,s.Z)(regeneratorRuntime.mark((function t(){var a,n,r,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=Object.assign({},e.form),a.timeStart&&(n=a.timeStart.split(":"),a.dateStart=new Date(a.dateStart),a.dateStart.setHours(parseInt(n[0]),parseInt(n[1]))),a.dateStart=e.$moment(a.dateStart).format(),0===e.typeData&&a.dateEnd&&(a.dateEnd=e.$moment(a.dateEnd).format()),1===e.typeData&&(a.date=a.dateStart),1!==e.typeData){t.next=8;break}return t.next=8,e.addAttachment(a.coverBlob).then((function(e){a.imageId=e.data.id})).catch((function(){return{}}));case 8:r=(0,i.Z)(a.blocks),t.prev=9,o=regeneratorRuntime.mark((function t(){var a,n,r,o,l,c,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=s.value,1!==a.type){t.next=18;break}n=(0,i.Z)(a.content.blocks),t.prev=3,o=regeneratorRuntime.mark((function t(){var a,n,s,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=r.value,2!==a.type||!a.content.imgName.blob){t.next=4;break}return t.next=4,e.addAttachment(a.content.imgName.blob).then((function(e){a.content.imgName.croppie=e.data.url})).catch((function(){return{}}));case 4:if(3!==a.type){t.next=22;break}n=(0,i.Z)(a.content.imagesName),t.prev=6,o=regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=s.value,!a["blob"]){t.next=4;break}return t.next=4,e.addAttachment(a["blob"]).then((function(e){a.croppie=e.data.url})).catch((function(){return{}}));case 4:delete a.original,delete a["blob"];case 6:case"end":return t.stop()}}),t)})),n.s();case 9:if((s=n.n()).done){t.next=13;break}return t.delegateYield(o(),"t0",11);case 11:t.next=9;break;case 13:t.next=18;break;case 15:t.prev=15,t.t1=t["catch"](6),n.e(t.t1);case 18:return t.prev=18,n.f(),t.finish(18);case 21:delete a.content.images;case 22:delete a.id,2===a.type&&(delete a.content.img,delete a.content.imgName.original,delete a.content.imgName.blob);case 24:case"end":return t.stop()}}),t,null,[[6,15,18,21]])})),n.s();case 6:if((r=n.n()).done){t.next=10;break}return t.delegateYield(o(),"t0",8);case 8:t.next=6;break;case 10:t.next=15;break;case 12:t.prev=12,t.t1=t["catch"](3),n.e(t.t1);case 15:return t.prev=15,n.f(),t.finish(15);case 18:if(2!==a.type||!a.content.imgName.blob){t.next=21;break}return t.next=21,e.addAttachment(a.content.imgName.blob).then((function(e){a.content.imgName.croppie=e.data.url})).catch((function(){return{}}));case 21:if(3!==a.type){t.next=39;break}l=(0,i.Z)(a.content.imagesName),t.prev=23,d=regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=c.value,!a["blob"]){t.next=4;break}return t.next=4,e.addAttachment(a["blob"]).then((function(e){a.croppie=e.data.url})).catch((function(){return{}}));case 4:delete a.original,delete a["blob"];case 6:case"end":return t.stop()}}),t)})),l.s();case 26:if((c=l.n()).done){t.next=30;break}return t.delegateYield(d(),"t2",28);case 28:t.next=26;break;case 30:t.next=35;break;case 32:t.prev=32,t.t3=t["catch"](23),l.e(t.t3);case 35:return t.prev=35,l.f(),t.finish(35);case 38:delete a.content.images;case 39:delete a.id,2===a.type&&(delete a.content.img,delete a.content.imgName.original,delete a.content.imgName.blob);case 41:case"end":return t.stop()}}),t,null,[[3,12,15,18],[23,32,35,38]])})),r.s();case 12:if((s=r.n()).done){t.next=16;break}return t.delegateYield(o(),"t0",14);case 14:t.next=12;break;case 16:t.next=21;break;case 18:t.prev=18,t.t1=t["catch"](9),r.e(t.t1);case 21:return t.prev=21,r.f(),t.finish(21);case 24:if(1!==e.typeData){t.next=27;break}return t.next=27,e.addNews(a);case 27:if(0!==e.typeData){t.next=30;break}return t.next=30,e.addAnnouncement(a);case 30:e.$router.push("/published").then();case 31:case"end":return t.stop()}}),t,null,[[9,18,21,24]])})))()},preview:function(){var e=this;this.previewData=Object.assign({},this.form),this.previewData.tags=[],this.previewData.tagsIds.forEach((function(t,a){e.previewData.tags[a]=e.tags.find((function(e){return e.id===t}))})),this.isPreview=!0}})},m=p,f=a(1001),h=a(43453),b=a.n(h),v=a(71835),g=a(63150),k=a(83702),C=a(82102),x=a(99846),y=a(96428),w=a(97047),D=a(62877),_=a(40314),B=(0,f.Z)(m,n,r,!1,null,null,null),I=B.exports;b()(B,{VAutocomplete:v.Z,VBtn:g.Z,VCheckbox:k.Z,VCol:C.Z,VContainer:x.Z,VIcon:y.Z,VImg:w.Z,VRow:D.Z,VTextField:_.Z})}}]);
//# sourceMappingURL=2121-legacy.be74ac8f.js.map